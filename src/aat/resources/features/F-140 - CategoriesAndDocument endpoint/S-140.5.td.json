{
  "title":"Categories defined, top-level Collection of document and Collection of document within complex types exist and User has case access and the Document read permissions - Hierarchy with the list of documents is returned in the response",
  "_guid_": "S-140.5",
  "_extends_": "F-140_Test_Data_Base",
	"specs": [
		"an active profile in CCD and has read access permissions for all the Document fields",
		"a case definition with category structure exists for the case type CT1",
    "a case definition with Collection of Document fields in CaseField tab and ComplexTab exist with the category Id for case type CT1",
    "a case C1, containing multiple document fields (as part of the Collection fields) *but without* the category_id in the Document type sub-field exists",
    "contains the given case reference C1 in the input",
    "contains a HTTP 200 status code",
    "contains the category"
	],

  "users": {
    "invokingUser": {
      "_extends_": "BeftaMasterCaseworker"
    }
  },

	"request": {
		"_extends_": "Common_Request",
    "pathVariables": {
      "cid": "${[scenarioContext][childContexts][F-140_CreateCase_hierarchyCollectionComplex][testData][actualResponse][body][id]}"
    }
	},

	"expectedResponse": {
		"_extends_": "Common_200_Response",
    "headers" : {
      "Connection": "[[ANYTHING_PRESENT]]",
      "Content-Encoding": "[[ANY_NULLABLE]]",
      "Keep-Alive": "[[ANYTHING_PRESENT]]",
      "Transfer-Encoding": "[[ANYTHING_PRESENT]]",
      "Strict-Transport-Security": "[[ANY_NULLABLE]]"
    },
    "body" : {
      "caseVersion": 1,
      "categories": [
        {
          "categoryId": "CategoryID1",
          "categoryName": "Evidences",
          "categoryOrder": 100,
          "documents": [
            {
              "document_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][self][href]}",
              "document_filename": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][originalDocumentName]}",
              "document_binary_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][binary][href]}",
              "attributePath": "evidenceDocuments.document1",
              "uploadTimestamp": "[[ANYTHING_PRESENT]]"
            },
            {

              "document_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][self][href]}",
              "document_filename": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][originalDocumentName]}",
              "document_binary_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][binary][href]}",
              "attributePath": "evidenceDocuments.document2",
              "uploadTimestamp": "[[ANYTHING_PRESENT]]"
            }
          ],
          "subCategories": []
        },
        {
          "categoryId": "CategoryID2",
          "categoryName": "Supporting",
          "categoryOrder": 110,
          "documents": [
            {
              "document_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][self][href]}",
              "document_filename": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][originalDocumentName]}",
              "document_binary_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][binary][href]}",
              "attributePath": "applicationDocuments.documentWithMetaData.document1",
              "uploadTimestamp": "[[ANYTHING_PRESENT]]"
            },
            {
              "document_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][self][href]}",
              "document_filename": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][originalDocumentName]}",
              "document_binary_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][binary][href]}",
              "attributePath": "applicationDocuments.documentWithMetaData.document2",
              "uploadTimestamp": "[[ANYTHING_PRESENT]]"
            }
          ],
          "subCategories": []
        },
        {
          "categoryId": "CategoryID3",
          "categoryName": "Party Documents",
          "categoryOrder": 120,
          "documents": [],
          "subCategories": [
            {
              "categoryId": " SubCategoryID1",
              "categoryName": "Proof Documents",
              "categoryOrder": 100,
              "documents": [
                {
                  "document_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][self][href]}",
                  "document_filename": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][originalDocumentName]}",
                  "document_binary_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][binary][href]}",
                  "attributePath": "ProofType.evidenceDocument.document1",
                  "uploadTimestamp": "[[ANYTHING_PRESENT]]"
                },
                {
                  "document_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][self][href]}",
                  "document_filename": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][originalDocumentName]}",
                  "document_binary_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][binary][href]}",
                  "attributePath": "ProofType.evidenceDocument.document2",
                  "uploadTimestamp": "[[ANYTHING_PRESENT]]"
                }
              ],
              "subCategories": []
            }
          ]
        }
      ],
      "unCategorisedDocuments": [
        {
          "document_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][self][href]}",
          "document_filename": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][originalDocumentName]}",
          "document_binary_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][binary][href]}",
          "attributePath": "miscellaneousDocuments.Document1",
          "uploadTimestamp": "[[ANYTHING_PRESENT]]"
        },
        {
          "document_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][self][href]}",
          "document_filename": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][originalDocumentName]}",
          "document_binary_url": "${[scenarioContext][childContexts][F-140_Document_Upload][testData][actualResponse][body][documents][0][_links][binary][href]}",
          "attributePath": "miscellaneousDocuments.Document2",
          "uploadTimestamp": "[[ANYTHING_PRESENT]]"
        }
      ]
    }
	}
}

